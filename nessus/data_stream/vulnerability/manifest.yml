title: Nessus Vulnerability
type: logs
streams:
  - input: cel
    title: Nessus Vulnerability data
    description: Collects vulnerability findings from completed Nessus scans with full plugin enrichment (CVE, CVSS, description).
    template_path: cel.yml.hbs
    vars:
      - name: interval
        type: text
        title: Collection Interval
        description: How often to poll Nessus for completed scans. Supports Go duration syntax (e.g. 1h, 30m).
        required: true
        show_user: true
        default: 1h
      - name: min_severity
        type: integer
        title: Minimum Severity
        description: "Minimum severity level to collect: 0=Info, 1=Low, 2=Medium, 3=High, 4=Critical."
        required: false
        show_user: true
        default: 0
      - name: tags
        type: text
        title: Tags
        multi: true
        required: true
        show_user: false
        default:
          - forwarded
          - nessus-vulnerability
elasticsearch:
  index_template:
    settings:
      number_of_shards: "1"
    mappings:
      dynamic: false
